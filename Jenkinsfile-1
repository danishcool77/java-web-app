def gv
pipeline {
  agent { label 'DANISH_MACHINE' }
  options {
    buildDiscarder(logRotator(numToKeepStr: '5'))
  }
  
  parameters
  {
  booleanParam (name:'executeTests', defaultValue: true, description: 'running test')
  }
 
  stages {
  
stage('init') {

steps
{

script
{
gv = load "script.groovy"
}}
}
			
    stage('Scan1') {
    
     environment
  {
  
  NAME = "danish"
   //AAA_SECRET_TEXT = credentials('GIT_REPO_')
  }
	
		      steps {
		       script {
		      gv.runApp()
		       }
		 
     //  echo "Hello ${NAME}"
     //  echo "credentails  ${AAA_SECRET_TEXT}"
      // echo "Branch ${env.GIT_BRANCH}"
	        }
      }
      
          stage('Scan2') {
	  //Stage "Scan2" skipped due to when conditional
	  when{
	  expression
	  {
	  GIT_BRANCH == "origin/master"
	  }
	  }
	
		      steps {
      // echo "Hello ${NAME}" not in global scope to access this
       echo "workspace ${WORKSPACE}"
       echo "Branch ${env.GIT_BRANCH}"
	        }
      }
      
        stage('Test') {
	  //Stage "Scan2" skipped due to when conditional
	  when{
	  expression
	  {
	  params.executeTests == true
	  }
	  }
	
		      steps {
    
       echo "running tests"
      
	        }
      }
      
      
    }
    
        }
